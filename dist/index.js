(()=>{"use strict";var t={d:(e,s)=>{for(var i in s)t.o(s,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:s[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{default:()=>n});var s=null,i=null;function r(t){var e=l(s.body);return{top:l(t).top-e.top}}function l(t){return t.getBoundingClientRect()}function o(){var t=navigator.userAgent.toLowerCase();return-1!=t.indexOf("safari")&&!(t.indexOf("chrome")>-1)}class h{constructor(){this.respState="",this.stickyObj=new Array,this.globalObj=new Array,this.progressObj=new Array,this.onScrollEvents=new Array,this.stEvent=new Map,this.glEvent=new Map,this.prEvent=new Map,this.sf=1,this.f=1,this.cf=1,this.s=.05,this.t=0,this.c=0,this.d=0,this.requestId=null,this.bottomScroll=0,this.isProg=!1,this.isProgTimeout=null,this.isEnabled=!0,s=document,i=window,this.wHeight=i.innerHeight,this.scrollEls=s.querySelectorAll("[data-scroll]"),this.globalEls=s.querySelectorAll("[data-scroll-global-progress]"),this.progressEls=s.querySelectorAll("[data-scroll-progress]"),this.stickyEls=s.querySelectorAll("[data-scroll-sticky-progress]"),this.lerpEls=s.querySelectorAll("[data-lerp]"),this.aGlobalEs=[],i.addEventListener("resize",(()=>{this.onResize()})),this.wheelBindFunc=this.onWheel.bind(this),this.scrollBindFunc=this.onScroll.bind(this),this.defaultScrollBindFunc=this.onDefaultScroll.bind(this),i.addEventListener("wheel",this.wheelBindFunc,{passive:!1}),i.addEventListener("scroll",this.scrollBindFunc,{passive:!1}),this.onAnimationFrame(),this.onIntersectionObserver(),this.onResize()}static getInstance(){return h.instance||(h.instance=new h),h.instance}setSpeed(t){this.s=t}setScrollFactor(t){this.f=t,o()?this.cf=this.f*this.sf:this.cf=this.f}setSafariFactor(t){this.sf=t,o()?this.cf=this.f*this.sf:this.cf=this.f}on(t,e){"scroll"===t&&this.onScrollEvents.push(e)}disable(){this.isEnabled&&(i.removeEventListener("wheel",this.wheelBindFunc),i.removeEventListener("scroll",this.scrollBindFunc),i.addEventListener("scroll",this.defaultScrollBindFunc),this.isEnabled=!1)}enable(){this.isEnabled||(i.removeEventListener("scroll",this.defaultScrollBindFunc),i.addEventListener("wheel",this.wheelBindFunc,{passive:!1}),i.addEventListener("scroll",this.scrollBindFunc,{passive:!1}),this.isEnabled=!0)}onWheel(t){t.preventDefault(),this.d=t.deltaY*this.cf,this.t+=this.d,this.t<0&&(this.t=0),this.t>this.bottomScroll&&(this.t=this.bottomScroll)}onScroll(t){t.preventDefault(),"d"==this.respState&&0==this.isProg&&(this.c=s.documentElement.scrollTop,this.t=s.documentElement.scrollTop,this.d=0),this.recalculate(),this.onScrollEvents.forEach((t=>{t(s.documentElement.scrollTop)}))}onDefaultScroll(t){this.c=s.documentElement.scrollTop,this.t=s.documentElement.scrollTop,this.recalculate(),this.onScrollEvents.forEach((t=>{t(s.documentElement.scrollTop)}))}onIntersectionObserver(){let t=new IntersectionObserver((t=>{t.forEach((t=>{if(t.isIntersecting)t.target.classList.add("-inview"),this.aGlobalEs.includes(t.target)||(this.aGlobalEs.push(t.target),this.sendElements());else{null!=t.target.getAttribute("data-scroll-repeat")&&t.target.classList.remove("-inview");let e=this.aGlobalEs.indexOf(t.target);-1!==e&&(this.aGlobalEs.splice(e,1),this.sendElements())}}))}),{root:null,rootMargin:"0px",threshold:.01});this.scrollEls.forEach((e=>{t.observe(e)}))}onAnimationFrame(){let t=()=>{if("d"==this.respState){let t=(e=this.c,i=this.t,r=this.s,l=1,o=e,h=i,(1-(n=1-Math.exp(-r*l)))*o+n*h),a=t-this.c;this.c=t,Math.abs(this.c-this.t)<1&&(this.c=this.t),0!=a&&(this.isProg=!0,s.documentElement.scrollTop=s.body.scrollTop=this.c,null!=this.isProgTimeout&&clearTimeout(this.isProgTimeout),this.isProgTimeout=setTimeout((()=>{this.isProg=!1}),100),a=Math.abs(a),this.lerpEls.forEach(((t,e)=>{this.lerpEls[e].style.setProperty("--scroll-lerp",a)})))}var e,i,r,l,o,h,n;this.recalculate(),requestAnimationFrame(t)};requestAnimationFrame(t)}recalculate(){this.stickyObj.forEach((t=>{let e=l(t.parent).height,s=(this.c+this.wHeight*this.c/e)/e;t.el.style.setProperty("--scroll-sticky-progress",s),this.eStic(t.id,s)})),this.globalObj.forEach((t=>{let e=(this.c+this.wHeight-t.top)/this.wHeight;t.el.style.setProperty("--scroll-global-progress",e),this.eGlob(t.id,e)})),this.progressObj.forEach((t=>{let e=(this.c-t.oBottom+this.wHeight-t.top)/(this.wHeight-t.oTop-t.oBottom);e>1&&(e=1),e<0&&(e=0),t.el.style.setProperty("--scroll-progress",e),this.eProg(t.id,t)}))}addStickyEvent(t,e){this.stEvent.set(t,e)}eStic(t,e){this.stEvent.has(t)&&this.stEvent.get(t)(e)}addGlobalEvent(t,e){this.glEvent.set(t,e)}eGlob(t,e){this.glEvent.has(t)&&this.glEvent.get(t)(e)}addProgressEvent(t,e){this.prEvent.set(t,e)}eProg(t,e){this.prEvent.has(t)&&this.prEvent.get(t)(e)}sendElements(){this.stickyObj=Array.from(this.stickyEls).map((t=>({el:t,top:t.getAttribute("data-offset-top"),height:t.getAttribute("data-offset-height"),id:t.getAttribute("data-scroll-id"),parent:t.parentNode}))),this.globalObj=Array.from(this.aGlobalEs).map((t=>({el:t,top:t.getAttribute("data-offset-top"),height:t.getAttribute("data-offset-height")}))),this.progressObj=Array.from(this.progressEls).map((t=>{var e=l(t),s=t.getAttribute("data-scroll-offset"),i=s?s.split(",").map((t=>function(t,e){if((t=t.trim()).endsWith("px"))return parseFloat(t);if(t.endsWith("%"))return parseFloat(t)*e/100;throw new Error(`Unknown format offset: ${t}`)}(t,this.wHeight))):[0,0];return{el:t,top:r(t).top,height:e.height,oTop:i[0],oBottom:i[1]}}))}initEl(t){var e=l(t);t.style.setProperty("--scroll-progress",0),t.style.setProperty("--scroll-global-progress",0),t.setAttribute("data-offset-top",r(t).top),t.setAttribute("data-offset-height",e.height)}onResize(){this.stickyEls.forEach((t=>{this.initEl(t)})),this.globalEls.forEach((t=>{this.initEl(t)})),this.sendElements();let t=s.body,e=s.documentElement,r=Math.max(t.scrollHeight,t.offsetHeight,e.clientHeight,e.scrollHeight,e.offsetHeight);this.wHeight=i.innerHeight,this.bottomScroll=r-this.wHeight,i.innerWidth>1024&&"d"!=this.respState&&(this.respState="d"),i.innerWidth<=1024&&"m"!=this.respState&&(this.respState="m")}}const n=h;module.exports=e})();